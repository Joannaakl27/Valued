<div class="container">
  <section class="mx-auto my-5" style="max-width: 23rem;">
    <div class="col-12 pr-3 pl-3">
      <h3 class= "text-black white mb-3">Search for a Product</h3>
      <div class="searchbar">
      <%= form_tag products_path, method: :get, class: "d-flex justify-content-between" do %>
          <%= text_field_tag :query,
              params[:query],
              class: "form-control",
              placeholder: "Search for a product"%>
        <div>
          <%= submit_tag "Search", class: "btn btn-primary ml-2" %>
        </div>
      <% end %>
      </div>
    </div>

    <div class="card-body rounded-bottom text-dark">
      <% @products.each do |product| %>
        <div class="row">
          <div class="col-12 p-1">
            <div class="card-index w-100">
              <div class="card-body">
                <div class="d-flex justify-content-between align-items-center px-md-1">
                  <div>
                    <p><%= product["product_name"] %></p>
                    <%= link_to "", "products/#{product["_id"]}" , class:"stretched-link" %>
                  </div>
                  <div class="align-self-center">
                    <img src= <%= product["image_front_url"] %> width="60" height="60" class="product-img">
                  </div>
                </div>
                <div class="px-md-1">
                  <% if product["ecoscore_grade"].upcase == "A" %>
                    <div class="progress mt-3 mb-1 rounded" style="height: 7px;">
                      <div class="progress-bar color-A" role="progressbar" style="width: <%= product["ecoscore_score"] %>%;" aria-valuenow="<%= product["ecoscore_score"] %>"
                        aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                  <% elsif product["ecoscore_grade"].upcase == "B" %>
                    <div class="progress mt-3 mb-1 rounded" style="height: 7px;">
                      <div class="progress-bar color-B" role="progressbar" style="width: <%= product["ecoscore_score"] %>%;" aria-valuenow="<%= product["ecoscore_score"] %>"
                        aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                  <% elsif product["ecoscore_grade"].upcase == "C" %>
                    <div class="progress mt-3 mb-1 rounded" style="height: 7px;">
                      <div class="progress-bar color-C" role="progressbar" style="width: <%= product["ecoscore_score"] %>%;" aria-valuenow="<%= product["ecoscore_score"] %>"
                        aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                  <% elsif product["ecoscore_grade"].upcase == "D" %>
                    <div class="progress mt-3 mb-1 rounded" style="height: 7px;">
                      <div class="progress-bar color-D" role="progressbar" style="width: <%= product["ecoscore_score"] %>%;" aria-valuenow="<%= product["ecoscore_score"] %>"
                        aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                  <% elsif product["ecoscore_grade"].upcase == "E" %>
                    <div class="progress mt-3 mb-1 rounded" style="height: 7px;">
                      <div class="progress-bar color-E" role="progressbar" style="width: <%= product["ecoscore_score"] %>%;" aria-valuenow="<%= product["ecoscore_score"] %>"
                        aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                  <%end%>
                </div>
              </div>
            </div>
          </div>
        </div>
      <% end %>
    </div>

  </section>
</div>
